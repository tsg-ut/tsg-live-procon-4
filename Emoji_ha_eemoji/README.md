# Emoji ha eemoji
-------ここからフレーバー(読まなくても大丈夫です)-------
TSGのslackには、大きな寿司を表示させるためのemojiがあります。
:void:  と :sushi-5_0_0: , :sushi-5_4_0:, :sushi-5_0_4:  などが同じ画像であるというのはよく知られた事実です。
頭回ってないのでフレーバーは後で考える

-------ここまでフレーバー-------


`#`,`.` が正方形に並び一辺の長さが2のべき乗であるような文字列の列を*画像*ということにします。
一方の画像の`#`,`.`を、同じ文字からなる画像で拡大するように置換することで他方の画像にできる場合、
2つの画像が*相似*であるといいます。

たとえば、以下の3つの画像はどれも相似です。
```
.#
..
```

```
..##
..##
....
....
```

```
....####
....####
....####
....####
........
........
........
........
```

また、すべての画像はそれ自身と相似です。

ある画像の*部分画像*を以下のように定義します。
* 画像それ自身
* 画像のサイズが1より大きいとき、
** 画像を田の字に4分割すると、左上、左下、右上、右下の4つの画像ができますが、これらの部分画像

たとえば、
```
....
.#..
#.#.
####
```
の部分画像は、
```
....
.#..
#.#.
####
```

```
..
.#
```

```
..
..
```

```
#.
##
```

```
#
```

```
.
```

の6種類あります。

画像の*容量*を、部分画像のうち相似であるもの同一視したときの、部分画像の種類数とします。
先程の画像の場合、部分画像は6種類ですが、
```
.
```
と
```
..
..
```
が相似であるので、容量は5となります。

一部が`?`になった画像が与えられるので、画像の容量を最小化するように`?`を`#`もしくは`.`で埋めた場合の画像の容量を答えてください。

## 入力フォーマット
入力は以下の形式で標準入力から与えられます。
```
$N$
$c_{11}c_{12}\cdotsc_{1N}$
$c_{21}c_{22}\cdotsc_{2N}$
$\vdots$
$\vdots$
$c_{N1}c_{N2}\cdotsc_{NN}$
```

## 出力フォーマット
答えを出力してください。

## 制約

* $ 1 \leqq N \leqq 1024 $
* $ N $ は2のべき乗
* 各 $c_{ij}$ は `#`,`.`,`?`のいずれかの文字
* 入力中の`?`の数はたかだか10個以下

## 入出力例

### 入力例1
```
4
....
.#..
#.#.
####
```

### 出力例1
```
5
```
問題文中にあるとおりです。

### 入力例2
```
16
.....###..#####?
....?.##..######
...?##.###..####
....###.##..?###
.?#?....####..##
#.##....####..##
##.#....######..
###.?...######?.
..######.....###
..######....#.##
##..####....##.#
##..####....###.
####..##.###....
####..?##.##....
######..##.#....
######..###.....
```

### 出力例2
```
6
```

対称性が高くなるように埋めると、
```
#
```
```
.
```
```
.#
#.
```
```
.###
#.##
##.#
###.
```
```
.....###
....#.##
....##.#
....###.
.###....
#.##....
##.#....
###.....
```
```
.....###..######
....#.##..######
....##.###..####
....###.##..####
.###....####..##
#.##....####..##
##.#....######..
###.....######..
..######.....###
..######....#.##
##..####....##.#
##..####....###.
####..##.###....
####..###.##....
######..##.#....
######..###.....
```

の6種類だけにすることができます。

### 入力例3
```

```

### 出力例3
```

```

